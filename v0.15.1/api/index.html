<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · TestParticle.jl</title><meta name="title" content="API · TestParticle.jl"/><meta property="og:title" content="API · TestParticle.jl"/><meta property="twitter:title" content="API · TestParticle.jl"/><meta name="description" content="Documentation for TestParticle.jl."/><meta property="og:description" content="Documentation for TestParticle.jl."/><meta property="twitter:description" content="Documentation for TestParticle.jl."/><meta property="og:url" content="https://henry2004y.github.io/TestParticle.jl/api/"/><meta property="twitter:url" content="https://henry2004y.github.io/TestParticle.jl/api/"/><link rel="canonical" href="https://henry2004y.github.io/TestParticle.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TestParticle.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Public-APIs"><span>Public APIs</span></a></li><li><a class="tocitem" href="#Private-types-and-methods"><span>Private types and methods</span></a></li></ul></li><li><a class="tocitem" href="../plotfunctions/">Plot Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/henry2004y/TestParticle.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/henry2004y/TestParticle.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal"><a class="docs-heading-anchor" href="#Internal">Internal</a><a id="Internal-1"></a><a class="docs-heading-anchor-permalink" href="#Internal" title="Permalink"></a></h1><h2 id="Public-APIs"><a class="docs-heading-anchor" href="#Public-APIs">Public APIs</a><a id="Public-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#Public-APIs" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="TestParticle.BiMaxwellian"><a class="docstring-binding" href="#TestParticle.BiMaxwellian"><code>TestParticle.BiMaxwellian</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Type for BiMaxwellian velocity distributions with respect to the magnetic field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L31-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.BiMaxwellian-Union{Tuple{U}, Tuple{T}, Tuple{AbstractVector{U}, AbstractVector{T}, Any, Any, Any}} where {T&lt;:AbstractFloat, U&lt;:AbstractFloat}"><a class="docstring-binding" href="#TestParticle.BiMaxwellian-Union{Tuple{U}, Tuple{T}, Tuple{AbstractVector{U}, AbstractVector{T}, Any, Any, Any}} where {T&lt;:AbstractFloat, U&lt;:AbstractFloat}"><code>TestParticle.BiMaxwellian</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> BiMaxwellian(B::Vector{U}, u0::Vector{T}, ppar, pperp, n; m=mᵢ)</code></pre><p>Construct a BiMaxwellian distribution with magnetic field <code>B</code>, bulk velocity <code>u0</code>, parallel thermal pressure <code>ppar</code>, perpendicular thermal pressure <code>pperp</code>, and number density <code>n</code> in SI units. The default particle is proton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L45-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Cartesian"><a class="docstring-binding" href="#TestParticle.Cartesian"><code>TestParticle.Cartesian</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Cartesian grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L7-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Maxwellian"><a class="docstring-binding" href="#TestParticle.Maxwellian"><code>TestParticle.Maxwellian</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Type for Maxwellian velocity distributions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L8-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Maxwellian-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any}} where T"><a class="docstring-binding" href="#TestParticle.Maxwellian-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any}} where T"><code>TestParticle.Maxwellian</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> Maxwellian(u0::AbstractVector{T}, p, n; m=mᵢ)</code></pre><p>Construct a Maxwellian distribution with bulk velocity <code>u0</code>, thermal pressure <code>p</code>, and number density <code>n</code> in SI units. The default particle is proton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L18-L23">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Spherical"><a class="docstring-binding" href="#TestParticle.Spherical"><code>TestParticle.Spherical</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Spherical grid with uniform r, θ and ϕ.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L11-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.SphericalNonUniformR"><a class="docstring-binding" href="#TestParticle.SphericalNonUniformR"><code>TestParticle.SphericalNonUniformR</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Spherical grid with non-uniform r and uniform θ, ϕ.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L15-L17">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.energy2velocity-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.energy2velocity-Tuple{Any}"><code>TestParticle.energy2velocity</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return velocity magnitude from energy in [eV].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L211-L213">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_energy-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.get_energy-Tuple{Any}"><code>TestParticle.get_energy</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Calculate the energy [eV] of a relativistic particle from γv.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L200-L202">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_energy-Tuple{SciMLBase.AbstractODESolution}"><a class="docstring-binding" href="#TestParticle.get_energy-Tuple{SciMLBase.AbstractODESolution}"><code>TestParticle.get_energy</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return the energy [eV] from relativistic <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L184-L186">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_gc-Tuple{Any, Any}"><a class="docstring-binding" href="#TestParticle.get_gc-Tuple{Any, Any}"><code>TestParticle.get_gc</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_gc(xu, param)
 get_gc(x, y, z, vx, vy, vz, bx, by, bz, q2m)</code></pre><p>Calculate the coordinates of the guiding center according to the phase space coordinates of a particle. Reference: <a href="https://en.wikipedia.org/wiki/Guiding_center">wiki</a></p><p>Nonrelativistic definition:</p><p class="math-container">\[\mathbf{X}=\mathbf{x}-m\frac{\mathbf{b}\times\mathbf{v}}{qB}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/gc.jl#L76-L88">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_gc_func-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.get_gc_func-Tuple{Any}"><code>TestParticle.get_gc_func</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_gc_func(param)</code></pre><p>Return the function for plotting the orbit of guiding center.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">param = prepare(E, B; species = Proton)
# The definitions of stateinit, tspan, E and B are ignored.
prob = ODEProblem(trace!, stateinit, tspan, param)
sol = solve(prob, Vern7(); dt = 2e-11)

f = Figure(fontsize = 18)
ax = Axis3(f[1, 1], aspect = :data)
gc = param |&gt; get_gc_func
gc_plot(x, y, z, vx, vy, vz) = (gc(SA[x, y, z, vx, vy, vz])...,)
lines!(ax, sol, idxs = (gc_plot, 1, 2, 3, 4, 5, 6))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/gc.jl#L136-L155">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_gyrofrequency"><a class="docstring-binding" href="#TestParticle.get_gyrofrequency"><code>TestParticle.get_gyrofrequency</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Return the gyrofrequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L130-L132">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_gyroperiod"><a class="docstring-binding" href="#TestParticle.get_gyroperiod"><code>TestParticle.get_gyroperiod</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Return the gyroperiod.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L154-L156">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_gyroradius-Tuple{AbstractFloat, AbstractFloat}"><a class="docstring-binding" href="#TestParticle.get_gyroradius-Tuple{AbstractFloat, AbstractFloat}"><code>TestParticle.get_gyroradius</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return the gyroradius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L141-L143">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_velocity-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.get_velocity-Tuple{Any}"><code>TestParticle.get_velocity</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return velocity from relativistic γv in <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L166-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.prepare"><a class="docstring-binding" href="#TestParticle.prepare"><code>TestParticle.prepare</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">prepare(args...; kwargs...) -&gt; (q2m, m, E, B, F)
prepare(E, B, F = ZeroField(); kwargs...)
prepare(grid::CartesianGrid, E, B, F = ZeroField(); kwargs...)
prepare(x, E, B, F = ZeroField(); dir = 1, kwargs...)
prepare(x, y, E, B, F = ZeroField(); kwargs...)
prepare(x, y, z, E, B, F = ZeroField(); kwargs...)</code></pre><p>Return a tuple consists of particle charge-mass ratio for a prescribed <code>species</code> of charge <code>q</code> and mass <code>m</code>, mass <code>m</code> for a prescribed <code>species</code>, analytic/interpolated EM field functions, and external force <code>F</code>.</p><p>Prescribed <code>species</code> are <code>Electron</code> and <code>Proton</code>; other species can be manually specified with <code>species=Ion/User</code>, <code>q</code> and <code>m</code>.</p><p>Direct range input for uniform grid in 1/2/3D is supported. For 1D grid, an additional keyword <code>dir</code> is used for specifying the spatial direction, 1 -&gt; x, 2 -&gt; y, 3 -&gt; z. For 3D grid, the default grid type is <code>Cartesian</code>. To use <code>Spherical</code> grid, an additional keyword <code>gridtype</code> is needed. For <code>Spherical</code> grid, dimensions of field arrays should be <code>(Br, Bθ, Bϕ)</code>.</p><p><strong>Keywords</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic.</li><li><code>species::Species=Proton</code>: particle species.</li><li><code>q=1.0</code>: particle charge. Only works when <code>Species=User</code>.</li><li><code>m=1.0</code>: particle mass. Only works when <code>Species=User</code>.</li><li><code>gridtype::Grid=Cartesian()</code>: type of grid in <code>Cartesian()</code>, <code>Spherical()</code>, <code>SphericalNonUniformR</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/prepare.jl#L81-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.sample-Union{Tuple{Maxwellian{U, T}}, Tuple{T}, Tuple{U}} where {U, T}"><a class="docstring-binding" href="#TestParticle.sample-Union{Tuple{Maxwellian{U, T}}, Tuple{T}, Tuple{U}} where {U, T}"><code>TestParticle.sample</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> sample(vdf::Maxwellian)</code></pre><p>Sample a 3D velocity from a <a href="#TestParticle.Maxwellian"><code>Maxwellian</code></a> distribution <code>vdf</code> using the Box-Muller method.</p><pre><code class="language-julia hljs"> sample(vdf::BiMaxwellian)</code></pre><p>Sample a 3D velocity from a <a href="#TestParticle.BiMaxwellian"><code>BiMaxwellian</code></a> distribution <code>vdf</code> using the Box-Muller method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L69-L77">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace!-NTuple{4, Any}"><a class="docstring-binding" href="#TestParticle.trace!-NTuple{4, Any}"><code>TestParticle.trace!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">trace!(dy, y, p, t)</code></pre><p>ODE equations for charged particle moving in static EM field and external force field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L25-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.trace-Tuple{Any, Any, Any}"><code>TestParticle.trace</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">trace(y, p, t) -&gt; SVector{6, Float64}</code></pre><p>ODE equations for charged particle moving in static EM field and external force field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L38-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_gc!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><a class="docstring-binding" href="#TestParticle.trace_gc!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_gc!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_gc!(dy, y, p, t)</code></pre><p>Guiding center equations for nonrelativistic charged particle moving in static EM field with in-place form. Variable <code>y = (x, y, z, u)</code>, where <code>u</code> is the velocity along the magnetic field at (x,y,z).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L154-L159">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_gc_1st!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><a class="docstring-binding" href="#TestParticle.trace_gc_1st!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_gc_1st!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>1st order approximation of guiding center equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L196-L198">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_gc_drifts!-NTuple{4, Any}"><a class="docstring-binding" href="#TestParticle.trace_gc_drifts!-NTuple{4, Any}"><code>TestParticle.trace_gc_drifts!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_gc_drifts!(dx, x, p, t)</code></pre><p>Equations for tracing the guiding center using analytical drifts, including the grad-B drift, curvature drift, and ExB drift. Parallel velocity is also added. This expression requires the full particle trajectory <code>p.sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L127-L132">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_normalized!-NTuple{4, Any}"><a class="docstring-binding" href="#TestParticle.trace_normalized!-NTuple{4, Any}"><code>TestParticle.trace_normalized!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_normalized!(dy, y, p, t)</code></pre><p>Normalized ODE equations for charged particle moving in static EM field with in-place form. If the field is in 2D X-Y plane, periodic boundary should be applied for the field in z via the extrapolation function provided by Interpolations.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L76-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_relativistic!-NTuple{4, Any}"><a class="docstring-binding" href="#TestParticle.trace_relativistic!-NTuple{4, Any}"><code>TestParticle.trace_relativistic!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_relativistic!(dy, y, p, t)</code></pre><p>ODE equations for relativistic charged particle (x, γv) moving in static EM field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L49-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_relativistic-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.trace_relativistic-Tuple{Any, Any, Any}"><code>TestParticle.trace_relativistic</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_relativistic(y, p, t) -&gt; SVector{6}</code></pre><p>ODE equations for relativistic charged particle (x, γv) moving in static EM field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L63-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_relativistic_normalized!-NTuple{4, Any}"><a class="docstring-binding" href="#TestParticle.trace_relativistic_normalized!-NTuple{4, Any}"><code>TestParticle.trace_relativistic_normalized!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_relativistic_normalized!(dy, y, p, t)</code></pre><p>Normalized ODE equations for relativistic charged particle (x, γv) moving in static EM field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L94-L98">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.trace_relativistic_normalized-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.trace_relativistic_normalized-Tuple{Any, Any, Any}"><code>TestParticle.trace_relativistic_normalized</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> trace_relativistic_normalized(y, p, t)</code></pre><p>Normalized ODE equations for relativistic charged particle (x, γv) moving in static EM field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/equations.jl#L111-L115">source</a></section></details></article><h2 id="Private-types-and-methods"><a class="docs-heading-anchor" href="#Private-types-and-methods">Private types and methods</a><a id="Private-types-and-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Private-types-and-methods" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="TestParticle.AbstractTraceSolution"><a class="docstring-binding" href="#TestParticle.AbstractTraceSolution"><code>TestParticle.AbstractTraceSolution</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Abstract type for tracing solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/TestParticle.jl#L36-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Field"><a class="docstring-binding" href="#TestParticle.Field"><code>TestParticle.Field</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs"> Field{itd, F} &lt;: AbstractField{itd}</code></pre><p>A representation of a field function <code>f</code>, defined by:</p><p>time-independent field</p><p class="math-container">\[\mathbf{F} = F(\mathbf{x}),\]</p><p>time-dependent field</p><p class="math-container">\[\mathbf{F} = F(\mathbf{x}, t).\]</p><p><strong>Arguments</strong></p><ul><li><code>field_function::Function</code>: the function of field.</li><li><code>itd::Bool</code>: whether the field function is time dependent.</li><li><code>F</code>: the type of <code>field_function</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/prepare.jl#L12-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.GCTuple"><a class="docstring-binding" href="#TestParticle.GCTuple"><code>TestParticle.GCTuple</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>The type of parameter tuple for guiding center problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/prepare.jl#L56-L58">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Grid"><a class="docstring-binding" href="#TestParticle.Grid"><code>TestParticle.Grid</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Type for grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L3-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.Species"><a class="docstring-binding" href="#TestParticle.Species"><code>TestParticle.Species</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Type for the particles, <code>Proton</code>, <code>Electron</code>, <code>Ion</code>, or <code>User</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/TestParticle.jl#L31-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.TraceSolution-Union{Tuple{Any}, Tuple{deriv}, Tuple{Any, Type{deriv}}} where deriv"><a class="docstring-binding" href="#TestParticle.TraceSolution-Union{Tuple{Any}, Tuple{deriv}, Tuple{Any, Type{deriv}}} where deriv"><code>TestParticle.TraceSolution</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Interpolate solution at time <code>x</code>. Forward tracing only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L52-L54">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.VDF"><a class="docstring-binding" href="#TestParticle.VDF"><code>TestParticle.VDF</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Abstract type for velocity distribution functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/sampler.jl#L3-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle._boris!-NTuple{8, Any}"><a class="docstring-binding" href="#TestParticle._boris!-NTuple{8, Any}"><code>TestParticle._boris!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Apply Boris method for particles with index in <code>irange</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L228-L230">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle._prepare-Tuple{TraceProblem, Any, Any, Any}"><a class="docstring-binding" href="#TestParticle._prepare-Tuple{TraceProblem, Any, Any, Any}"><code>TestParticle._prepare</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Prepare for advancing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L216-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.cart2sph-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.cart2sph-Tuple{Any, Any, Any}"><code>TestParticle.cart2sph</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert from Cartesian to spherical coordinates vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L14-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.cross!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.cross!-Tuple{Any, Any, Any}"><code>TestParticle.cross!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>In-place cross product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L167-L169">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.dipole-Tuple{Any, Any}"><a class="docstring-binding" href="#TestParticle.dipole-Tuple{Any, Any}"><code>TestParticle.dipole</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Calculates the magnetic field from a dipole with magnetic moment <code>M</code> at <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/dipole.jl#L16-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.dipole_fieldline"><a class="docstring-binding" href="#TestParticle.dipole_fieldline"><code>TestParticle.dipole_fieldline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> dipole_fieldline(ϕ, L=2.5, nP=100)</code></pre><p>Creates <code>nP</code> points on one field line of the magnetic field from a dipole. In a centered dipole magnetic field model, the path along a given L shell can be described as r = L*cos²λ, where r is the radial distance (in planetary radii) to a point on the line, λ is its co-latitude, and L is the L-shell of interest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/dipole.jl#L29-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_CS_harris"><a class="docstring-binding" href="#TestParticle.getB_CS_harris"><code>TestParticle.getB_CS_harris</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> getB_CS_harris(B₀, L)</code></pre><p>Return the magnetic field at location <code>r</code> near a current sheet with magnetic strength <code>B₀</code> and sheet length <code>L</code>. The current sheet is assumed to lie in the z = 0 plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/current_sheet.jl#L3-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_bottle-NTuple{8, Any}"><a class="docstring-binding" href="#TestParticle.getB_bottle-NTuple{8, Any}"><code>TestParticle.getB_bottle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getB_bottle(x, y, z, distance, a, b, I1, I2) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field from a magnetic bottle. Reference: <a href="https://en.wikipedia.org/wiki/Magnetic_mirror#Magnetic_bottles">wiki</a></p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>b::Float</code>: radius of central coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils in [A].</li><li><code>I2::Float</code>: current in the central solenoid times number of windings in the central loop in [A].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/confinement.jl#L70-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_current_loop-Tuple{Any, Any, Any, TestParticle.Currentloop}"><a class="docstring-binding" href="#TestParticle.getB_current_loop-Tuple{Any, Any, Any, TestParticle.Currentloop}"><code>TestParticle.getB_current_loop</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getB_current_loop(x, y, z, cl::Currentloop) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field at <code>[x, y, z]</code> from a magnetic mirror generated from two coils.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/confinement.jl#L18-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_dipole-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.getB_dipole-Tuple{Any}"><code>TestParticle.getB_dipole</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Analytic magnetic field function for testing. Return in SI unit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/dipole.jl#L8-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_mirror-NTuple{6, Any}"><a class="docstring-binding" href="#TestParticle.getB_mirror-NTuple{6, Any}"><code>TestParticle.getB_mirror</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getB_mirror(x, y, z, distance, a, I1) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field at <code>[x, y, z]</code> from a magnetic mirror generated from two coils.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/confinement.jl#L43-L54">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_tokamak_coil-NTuple{7, Any}"><a class="docstring-binding" href="#TestParticle.getB_tokamak_coil-NTuple{7, Any}"><code>TestParticle.getB_tokamak_coil</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getB_tokamak_coil(x, y, z, a, b, ICoils, IPlasma) -&gt; StaticVector{Float64, 3}</code></pre><p>Get the magnetic field from a Tokamak topology consists of 16 coils. Original: <a href="https://github.com/BoschSamuel/Simulation-of-a-Tokamak-Fusion-Reactor/blob/master/Simulation2.m">Tokamak-Fusion-Reactor</a></p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: location in [m].</li><li><code>a::Float</code>: radius of each coil in [m].</li><li><code>b::Float</code>: radius of central region in [m].</li><li><code>ICoil::Float</code>: current in the coil times number of windings in [A].</li><li><code>IPlasma::Float</code>: current of the plasma in [A].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/confinement.jl#L101-L114">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getB_tokamak_profile-Tuple{AbstractFloat, AbstractFloat, AbstractFloat, Any, AbstractFloat, AbstractFloat, AbstractFloat}"><a class="docstring-binding" href="#TestParticle.getB_tokamak_profile-Tuple{AbstractFloat, AbstractFloat, AbstractFloat, Any, AbstractFloat, AbstractFloat, AbstractFloat}"><code>TestParticle.getB_tokamak_profile</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getB_tokamak_profile(x, y, z, q_profile, a, R₀, Bζ0) -&gt; StaticVector{Float64, 3}</code></pre><p>Reconstruct the magnetic field distribution from a safe factor(q) profile. Reference: Tokamak, 4th Edition, John Wesson.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: location in [m].</li><li><code>q_profile::Function</code>: profile of q. The variable of this function must be the normalized radius.</li><li><code>a::Float</code>: minor radius [m].</li><li><code>R₀::Float</code>: major radius [m].</li><li><code>Bζ0::Float</code>: toroidal magnetic field on axis [T].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/confinement.jl#L186-L199">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getE_dipole-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.getE_dipole-Tuple{Any}"><code>TestParticle.getE_dipole</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Analytic electric field function for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/dipole.jl#L3-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_interpolator-Union{Tuple{T}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any, Int64}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any, Int64, Int64}} where T"><a class="docstring-binding" href="#TestParticle.get_interpolator-Union{Tuple{T}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any, Int64}, Tuple{Cartesian, AbstractArray{T, 4}, Any, Any, Any, Int64, Int64}} where T"><code>TestParticle.get_interpolator</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_interpolator(A, gridx, gridy, gridz, order::Int=1, bc::Int=1)
 get_interpolator(gridtype, A, grid1, grid2, grid3, order::Int=1, bc::Int=1)</code></pre><p>Return a function for interpolating field array <code>A</code> on the grid given by <code>gridx</code>, <code>gridy</code>, and <code>gridz</code>.</p><p><strong>Arguments</strong></p><ul><li><code>gridtype</code>: <code>Cartesian</code>, <code>Spherical</code> or <code>SphericalNonUniformR</code>.</li><li><code>A</code>: field array. For vector field, the first dimension should be 3.</li><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic, 3 -&gt; Flat.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L163-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.get_rotation_matrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}"><a class="docstring-binding" href="#TestParticle.get_rotation_matrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}"><code>TestParticle.get_rotation_matrix</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> get_rotation_matrix(axis::AbstractVector, angle::Real) --&gt; SMatrix{3,3}</code></pre><p>Create a rotation matrix for rotating a 3D vector around a unit <code>axis</code> by an <code>angle</code> in radians. Reference: <a href="https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle">Rotation matrix from axis and angle</a></p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using LinearAlgebra
v = [-0.5, 1.0, 1.0]
v̂ = normalize(v)
θ = deg2rad(-74)
R = get_rotation_matrix(v̂, θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L105-L121">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getchargemass-Tuple{TestParticle.Species, Real, Real}"><a class="docstring-binding" href="#TestParticle.getchargemass-Tuple{TestParticle.Species, Real, Real}"><code>TestParticle.getchargemass</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> getchargemass(species::Species, q, m)</code></pre><p>Return charge and mass for <code>species</code>. For <code>species = Ion</code>, <code>q</code> and <code>m</code> are charge and mass numbers. For <code>species = User</code>, the input <code>q</code> and <code>m</code> are returned as is.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L46-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getinterp"><a class="docstring-binding" href="#TestParticle.getinterp"><code>TestParticle.getinterp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> getinterp(::Grid, A, gridx, gridy, gridz, order::Int=1, bc::Int=1)</code></pre><p>Return a function for interpolating field array <code>A</code> on the grid given by <code>gridx</code>, <code>gridy</code>, and <code>gridz</code>.</p><p><strong>Arguments</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic, 3 -&gt; Flat.</li><li><code>dir::Int</code>: 1/2/3, representing x/y/z direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L30-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.getinterp_scalar"><a class="docstring-binding" href="#TestParticle.getinterp_scalar"><code>TestParticle.getinterp_scalar</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> getinterp_scalar(::Grid, A, gridx, gridy, gridz, order::Int=1, bc::Int=1)</code></pre><p>Return a function for interpolating scalar array <code>A</code> on the grid given by <code>gridx</code>, <code>gridy</code>, and <code>gridz</code>. Currently only 3D arrays are supported.</p><p><strong>Arguments</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic, 3 -&gt; Flat.</li><li><code>dir::Int</code>: 1/2/3, representing x/y/z direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/interpolation.jl#L141-L152">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.is_time_dependent-Tuple{Function}"><a class="docstring-binding" href="#TestParticle.is_time_dependent-Tuple{Function}"><code>TestParticle.is_time_dependent</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Judge whether the field function is time dependent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/prepare.jl#L7-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.makegrid-Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.𝔼, C&lt;:CoordRefSystems.Cartesian, N}}"><a class="docstring-binding" href="#TestParticle.makegrid-Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.𝔼, C&lt;:CoordRefSystems.Cartesian, N}}"><code>TestParticle.makegrid</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Return uniform range from 2D/3D CartesianGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L66-L68">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.set_axes_equal-Tuple{Any}"><a class="docstring-binding" href="#TestParticle.set_axes_equal-Tuple{Any}"><code>TestParticle.set_axes_equal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> set_axes_equal(ax)</code></pre><p>Set 3D plot axes to equal scale for Matplotlib. Make axes of 3D plot have equal scale so that spheres appear as spheres and cubes as cubes. Required since <code>ax.axis(&#39;equal&#39;)</code> and <code>ax.set_aspect(&#39;equal&#39;)</code> don&#39;t work on 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L85-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.solve"><a class="docstring-binding" href="#TestParticle.solve"><code>TestParticle.solve</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> solve(prob::TraceProblem; trajectories::Int=1, dt::AbstractFloat,
	 savestepinterval::Int=1, isoutofdomain::Function=ODE_DEFAULT_ISOUTOFDOMAIN)</code></pre><p>Trace particles using the Boris method with specified <code>prob</code>.</p><p><strong>keywords</strong></p><ul><li><code>trajectories::Int</code>: number of trajectories to trace.</li><li><code>dt::AbstractFloat</code>: time step.</li><li><code>savestepinterval::Int</code>: saving output interval.</li><li><code>isoutofdomain::Function</code>: a function with input of position and velocity vector <code>xv</code> that determines whether to stop tracing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L178-L190">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.sph2cart-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TestParticle.sph2cart-Tuple{Any, Any, Any}"><code>TestParticle.sph2cart</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert from spherical to Cartesian coordinates vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L3-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.sph_to_cart_vector-NTuple{5, Any}"><a class="docstring-binding" href="#TestParticle.sph_to_cart_vector-NTuple{5, Any}"><code>TestParticle.sph_to_cart_vector</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Convert a vector from spherical to Cartesian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/utility/utility.jl#L29-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.update_location!-Tuple{Any, Any}"><a class="docstring-binding" href="#TestParticle.update_location!-Tuple{Any, Any}"><code>TestParticle.update_location!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Update location in one timestep <code>dt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L156-L158">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TestParticle.update_velocity!-NTuple{5, Any}"><a class="docstring-binding" href="#TestParticle.update_velocity!-NTuple{5, Any}"><code>TestParticle.update_velocity!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs"> update_velocity!(xv, paramBoris, param, dt, t)</code></pre><p>Update velocity using the Boris method, Birdsall, Plasma Physics via Computer Simulation. Reference: <a href="https://apps.dtic.mil/sti/citations/ADA023511">DTIC</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/09c76ca1b6ea82ce4161881a9cd1f6a20b11f4f1/src/pusher.jl#L114-L119">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><a class="docs-footer-nextpage" href="../plotfunctions/">Plot Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 27 November 2025 04:40">Thursday 27 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
