import{_ as t,C as l,o as h,c as p,aA as n,j as i,a as k,E as e,w as r}from"./chunks/framework.C_BvjEAf.js";const C=JSON.parse('{"title":"Unit support","description":"","frontmatter":{},"headers":[],"relativePath":"features/demo_unitful.md","filePath":"features/demo_unitful.md","lastUpdated":null}'),d={name:"features/demo_unitful.md"},g={class:"jldocstring custom-block",open:""};function E(y,s,o,m,c,F){const a=l("Badge");return h(),p("div",null,[s[4]||(s[4]=n(`<h1 id="Unit-support" tabindex="-1">Unit support <a class="header-anchor" href="#Unit-support" aria-label="Permalink to &quot;Unit support {#Unit-support}&quot;">â€‹</a></h1><p>This example shows how to trace charged particles with Unitful units.</p><p>TL;DR: Tracing with units is convenient although not as performant as tracing in dimensionless units.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TestParticle, StaticArrays</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unitful</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OrdinaryDiffEqVerner</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TestParticle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bmag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-8</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;T&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Î© </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Unitful</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">q) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bmag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unitful</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Î© </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;s&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Emag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-8</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V/m&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">B</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;T&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;T&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Bmag]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SA[Emag, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V/m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V/m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # [m]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unitful</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c0 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [m/s]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tspan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;s&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2Ï€</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_max) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># [s]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">param </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(E, B, q </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unitful</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">q, m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unitful</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(trace!, u0, tspan, param)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">retcode: Success</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Interpolation: specialized 9th order lazy interpolation</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t: 20-element Vector{Unitful.Quantity{Float64, ğ“, Unitful.FreeUnits{(s,), ğ“, nothing}}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.0 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.4088344909683774e-10 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.925859561433506e-9 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.3194349022483877e-8 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 8.812966040768264e-8 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.494574873428513e-7 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.4629406848752854e-6 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.148429027387439e-5 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.00012918278550991505 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.000730736126206529 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.004081541295463183 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.022937388071097683 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.12877413196982104 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.6213053233871128 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.5037537833398693 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.6140719028720536 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.793135407570003 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.061853931919584 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.437803884405918 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.5594474868589705 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">u: 20-element Vector{Vector{Unitful.Quantity{Float64}}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.0 m, 0.0 m, 0.0 m, 0.0 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [8.331388431966723e-14 m, 0.0007221504129625887 m, 0.0 m, 0.0006917360626646803 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.3254055810762926e-12 m, 0.005773581716849528 m, 0.0 m, 0.005530419442539567 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.499651115455538e-10 m, 0.03955566325160339 m, 0.0 m, 0.03788972250462677 m s^-1, 2.9979245799999996e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1151868872734071e-8 m, 0.26420607516324424 m, 0.0 m, 0.25307867569547343 m s^-1, 2.9979245799999894e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.3348258297628074e-7 m, 1.647232106970097 m, 0.0 m, 1.5778566784941657 m s^-1, 2.9979245799995847e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.7218430678788385e-5 m, 10.381634998250615 m, 0.0 m, 9.94439827050789 m s^-1, 2.997924579983507e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.0006627435105106637 m, 64.40828189135667 m, 0.0 m, 61.69563918927235 m s^-1, 2.997924579365169e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.023961430944091422 m, 387.2802470046967 m, 0.0 m, 370.96941080709803 m s^-1, 2.997924557047745e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.7666984765891037 m, 2190.691615362459 m, 0.0 m, 2098.4276479281075 m s^-1, 2.9979238455923214e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [23.919455956688612 m, 12236.121801781845 m, 0.0 m, 11720.780831147582 m s^-1, 2.9979016679522214e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [755.3946673017898 m, 68759.02706562518 m, 0.0 m, 65863.14679400499 m s^-1, 2.997201000051503e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [23779.898179761392 m, 385076.88449089293 m, 0.0 m, 368858.8462254769 m s^-1, 2.9751462122870744e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [538092.6069289364 m, 1.7546036335232435e6 m, 0.0 m, 1.6807061411711655e6 m s^-1, 2.4824946495780963e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.722852914234935e6 m, 3.103176622232147e6 m, 0.0 m, 2.9724825521993074e6 m s^-1, 389749.2026368658 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.644538065119795e6 m, 1.8630757004553287e6 m, 0.0 m, 1.7846116331313036e6 m s^-1, -2.4088842568155425e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.888573180714667e6 m, -1.4778767264858738e6 m, 0.0 m, -1.4156298254249124e6 m s^-1, -2.6426414224630124e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.7045489242454525e6 m, -3.1007275429247064e6 m, 0.0 m, -2.9701303309060545e6 m s^-1, 407282.28925659746 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [21223.86367614255 m, -363859.6938069101 m, 0.0 m, -348528.9632499821 m s^-1, 2.9775945950921746e6 m s^-1, 0.0 m s^-1]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.7093031248411283 m, -6.190710236927165 m, 0.0 m, 0.35320726048385764 m s^-1, 2.997922942687056e6 m s^-1, 0.0 m s^-1]</span></span></code></pre></div><h2 id="Heterogeneous-arrays-with-ArrayPartition" tabindex="-1">Heterogeneous arrays with <code>ArrayPartition</code> <a class="header-anchor" href="#Heterogeneous-arrays-with-ArrayPartition" aria-label="Permalink to &quot;Heterogeneous arrays with \`ArrayPartition\` {#Heterogeneous-arrays-with-ArrayPartition}&quot;">â€‹</a></h2><p><code>ArrayPartitions</code> in DiffEq can be used for heterogeneous arrays. See <a href="https://docs.sciml.ai/DiffEqDocs/stable/features/diffeq_arrays" target="_blank" rel="noreferrer">https://docs.sciml.ai/DiffEqDocs/stable/features/diffeq_arrays</a> for more details.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RecursiveArrayTools</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ArrayPartition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x0, v0)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(trace!, u0_p, tspan, param)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_p, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">retcode: Success</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Interpolation: specialized 9th order lazy interpolation</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t: 20-element Vector{Unitful.Quantity{Float64, ğ“, Unitful.FreeUnits{(s,), ğ“, nothing}}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.0 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.4088344909683774e-10 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.925859561433506e-9 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.3194349022483877e-8 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 8.812966040768264e-8 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.494574873428513e-7 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.4629406848752854e-6 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.148429027387439e-5 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.00012918278550991505 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.000730736126206529 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.004081541295463183 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.022937388071097683 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.12877413196982104 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.6213053233871128 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.5037537833398693 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.6140719028720536 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.793135407570003 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.061853931919584 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.437803884405918 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.5594474868589705 s</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">u: 20-element Vector{RecursiveArrayTools.ArrayPartition{Unitful.Quantity{Float64}, Tuple{Vector{Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}}, Vector{Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}}}}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.0 m, 0.0 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.0 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[8.331388431966723e-14 m, 0.0007221504129625887 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.0006917360626646803 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[5.3254055810762926e-12 m, 0.005773581716849528 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.005530419442539567 m s^-1, 2.99792458e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[2.499651115455538e-10 m, 0.03955566325160339 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.03788972250462677 m s^-1, 2.9979245799999996e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[1.1151868872734071e-8 m, 0.26420607516324424 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.25307867569547343 m s^-1, 2.9979245799999894e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[4.3348258297628074e-7 m, 1.647232106970097 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[1.5778566784941657 m s^-1, 2.9979245799995847e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[1.7218430678788385e-5 m, 10.381634998250615 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[9.94439827050789 m s^-1, 2.997924579983507e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.0006627435105106637 m, 64.40828189135667 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[61.69563918927235 m s^-1, 2.997924579365169e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.023961430944091422 m, 387.2802470046967 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[370.96941080709803 m s^-1, 2.997924557047745e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[0.7666984765891037 m, 2190.691615362459 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[2098.4276479281075 m s^-1, 2.9979238455923214e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[23.919455956688612 m, 12236.121801781845 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[11720.780831147582 m s^-1, 2.9979016679522214e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[755.3946673017898 m, 68759.02706562518 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[65863.14679400499 m s^-1, 2.997201000051503e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[23779.898179761392 m, 385076.88449089293 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[368858.8462254769 m s^-1, 2.9751462122870744e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[538092.6069289364 m, 1.7546036335232435e6 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[1.6807061411711655e6 m s^-1, 2.4824946495780963e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[2.722852914234935e6 m, 3.103176622232147e6 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[2.9724825521993074e6 m s^-1, 389749.2026368658 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[5.644538065119795e6 m, 1.8630757004553287e6 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[1.7846116331313036e6 m s^-1, -2.4088842568155425e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[5.888573180714667e6 m, -1.4778767264858738e6 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[-1.4156298254249124e6 m s^-1, -2.6426414224630124e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[2.7045489242454525e6 m, -3.1007275429247064e6 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[-2.9701303309060545e6 m s^-1, 407282.28925659746 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[21223.86367614255 m, -363859.6938069101 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[-348528.9632499821 m s^-1, 2.9775945950921746e6 m s^-1, 0.0 m s^-1])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> (Unitful.Quantity{Float64, ğ‹, Unitful.FreeUnits{(m,), ğ‹, nothing}}[1.7093031248411283 m, -6.190710236927165 m, 0.0 m], Unitful.Quantity{Float64, ğ‹ ğ“^-1, Unitful.FreeUnits{(m, s^-1), ğ‹ ğ“^-1, nothing}}[0.35320726048385764 m s^-1, 2.997922942687056e6 m s^-1, 0.0 m s^-1])</span></span></code></pre></div><h2 id="Tracing-in-standard-SI-units" tabindex="-1">Tracing in standard SI units <a class="header-anchor" href="#Tracing-in-standard-SI-units" aria-label="Permalink to &quot;Tracing in standard SI units {#Tracing-in-standard-SI-units}&quot;">â€‹</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bmag_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bmag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;T&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Emag_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Emag </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V/m&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### Solving in SI units</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">B_SI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SA[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Bmag_SI]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">E_SI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SA[Emag_SI, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## Initial conditions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x0_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v0_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u0_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x0_SI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, v0_SI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tspan_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tspan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;s&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # [s]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">param_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(E_SI, B_SI, species </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Proton)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ODEProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(trace!, u0_SI, tspan_SI, param_SI)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sol_SI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_SI, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">retcode: Success</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Interpolation: specialized 9th order lazy interpolation</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t: 20-element Vector{Float64}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.4088344909683774e-10</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.925859561433506e-9</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.3194349022483877e-8</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 8.812966040768264e-8</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.494574873428513e-7</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.4629406848752854e-6</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.148429027387439e-5</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.00012918278550991505</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.000730736126206529</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.004081541295463183</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.022937388071097683</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.12877413196982104</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 0.6213053233871128</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 1.5037537833398693</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 2.6140719028720536</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 3.793135407570003</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 5.061853931919584</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.437803884405918</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 6.5594474868589705</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">u: 20-element Vector{Vector{Float64}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.0, 0.0, 0.0, 0.0, 2.99792458e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [8.331388431966723e-14, 0.0007221504129625887, 0.0, 0.0006917360626646803, 2.99792458e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.3254055810762926e-12, 0.005773581716849528, 0.0, 0.005530419442539567, 2.99792458e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.499651115455538e-10, 0.03955566325160339, 0.0, 0.03788972250462677, 2.9979245799999996e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1151868872734071e-8, 0.26420607516324424, 0.0, 0.25307867569547343, 2.9979245799999894e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.3348258297628074e-7, 1.647232106970097, 0.0, 1.5778566784941657, 2.9979245799995847e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.7218430678788385e-5, 10.381634998250615, 0.0, 9.94439827050789, 2.997924579983507e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.0006627435105106637, 64.40828189135667, 0.0, 61.69563918927235, 2.997924579365169e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.023961430944091422, 387.2802470046967, 0.0, 370.96941080709803, 2.997924557047745e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [0.7666984765891037, 2190.691615362459, 0.0, 2098.4276479281075, 2.9979238455923214e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [23.919455956688612, 12236.121801781845, 0.0, 11720.780831147582, 2.9979016679522214e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [755.3946673017898, 68759.02706562518, 0.0, 65863.14679400499, 2.997201000051503e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [23779.898179761392, 385076.88449089293, 0.0, 368858.8462254769, 2.9751462122870744e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [538092.6069289364, 1.7546036335232435e6, 0.0, 1.6807061411711655e6, 2.4824946495780963e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.722852914234935e6, 3.103176622232147e6, 0.0, 2.9724825521993074e6, 389749.2026368658, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.644538065119795e6, 1.8630757004553287e6, 0.0, 1.7846116331313036e6, -2.4088842568155425e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.888573180714667e6, -1.4778767264858738e6, 0.0, -1.4156298254249124e6, -2.6426414224630124e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.7045489242454525e6, -3.1007275429247064e6, 0.0, -2.9701303309060545e6, 407282.28925659746, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [21223.86367614255, -363859.6938069101, 0.0, -348528.9632499821, 2.9775945950921746e6, 0.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.7093031248411283, -6.190710236927165, 0.0, 0.35320726048385764, 2.997922942687056e6, 0.0]</span></span></code></pre></div><h2 id="Compare-performance" tabindex="-1">Compare performance <a class="header-anchor" href="#Compare-performance" aria-label="Permalink to &quot;Compare performance {#Compare-performance}&quot;">â€‹</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Chairmarks</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_SI, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;SI units (unitless)&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16.194</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Î¼s (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">528</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allocs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 31.445</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KiB)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob_p, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;Partitioned (unitful)&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">165.328</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Î¼s (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3437</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allocs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 136.211</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KiB)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> solve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vern9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;Basic (unitful)&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.238</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ms (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20053</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allocs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 384.453</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KiB)</span></span></code></pre></div><h2 id="Related-API" tabindex="-1">Related API <a class="header-anchor" href="#Related-API" aria-label="Permalink to &quot;Related API {#Related-API}&quot;">â€‹</a></h2>`,15)),i("details",g,[i("summary",null,[s[0]||(s[0]=i("a",{id:"TestParticle.trace!-features-demo_unitful",href:"#TestParticle.trace!-features-demo_unitful"},[i("span",{class:"jlbinding"},"TestParticle.trace!")],-1)),s[1]||(s[1]=k()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[3]||(s[3]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">trace!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dy, y, p, t)</span></span></code></pre></div><p>ODE equations for charged particle moving in EM field and external force field with in-place form.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:r(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/henry2004y/TestParticle.jl/blob/35e77ae3e67bd601f6b624710a2cbc11c3839484/src/equations.jl#L25-L29",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const f=t(d,[["render",E]]);export{C as __pageData,f as default};
