<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API ¬∑ TestParticle.jl</title><meta name="title" content="API ¬∑ TestParticle.jl"/><meta property="og:title" content="API ¬∑ TestParticle.jl"/><meta property="twitter:title" content="API ¬∑ TestParticle.jl"/><meta name="description" content="Documentation for TestParticle.jl."/><meta property="og:description" content="Documentation for TestParticle.jl."/><meta property="twitter:description" content="Documentation for TestParticle.jl."/><meta property="og:url" content="https://henry2004y.github.io/TestParticle.jl/api/"/><meta property="twitter:url" content="https://henry2004y.github.io/TestParticle.jl/api/"/><link rel="canonical" href="https://henry2004y.github.io/TestParticle.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TestParticle.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Public-APIs"><span>Public APIs</span></a></li><li><a class="tocitem" href="#Private-types-and-methods"><span>Private types and methods</span></a></li></ul></li><li><a class="tocitem" href="../plotfunctions/">Plot Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/henry2004y/TestParticle.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/henry2004y/TestParticle.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal"><a class="docs-heading-anchor" href="#Internal">Internal</a><a id="Internal-1"></a><a class="docs-heading-anchor-permalink" href="#Internal" title="Permalink"></a></h1><h2 id="Public-APIs"><a class="docs-heading-anchor" href="#Public-APIs">Public APIs</a><a id="Public-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#Public-APIs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.BiMaxwellian" href="#TestParticle.BiMaxwellian"><code>TestParticle.BiMaxwellian</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type for BiMaxwellian velocity distributions with respect to the magnetic field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L31-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.BiMaxwellian-Union{Tuple{U}, Tuple{T}, Tuple{AbstractVector{U}, AbstractVector{T}, Any, Any, Any}} where {T&lt;:AbstractFloat, U&lt;:AbstractFloat}" href="#TestParticle.BiMaxwellian-Union{Tuple{U}, Tuple{T}, Tuple{AbstractVector{U}, AbstractVector{T}, Any, Any, Any}} where {T&lt;:AbstractFloat, U&lt;:AbstractFloat}"><code>TestParticle.BiMaxwellian</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> BiMaxwellian(B::Vector{U}, u0::Vector{T}, ppar, pperp, n; m=m·µ¢)</code></pre><p>Construct a BiMaxwellian distribution with magnetic field <code>B</code>, bulk velocity <code>u0</code>, parallel thermal pressure <code>ppar</code>, perpendicular thermal pressure <code>pperp</code>, and number density <code>n</code> in SI units. The default particle is proton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L45-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.Maxwellian" href="#TestParticle.Maxwellian"><code>TestParticle.Maxwellian</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type for Maxwellian velocity distributions. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L8-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.Maxwellian-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any}} where T" href="#TestParticle.Maxwellian-Union{Tuple{T}, Tuple{AbstractVector{T}, Any, Any}} where T"><code>TestParticle.Maxwellian</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> Maxwellian(u0::AbstractVector{T}, p, n; m=m·µ¢)</code></pre><p>Construct a Maxwellian distribution with bulk velocity <code>u0</code>, thermal pressure <code>p</code>, and number density <code>n</code> in SI units. The default particle is proton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.energy2velocity-Tuple{Any}" href="#TestParticle.energy2velocity-Tuple{Any}"><code>TestParticle.energy2velocity</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return velocity magnitude from energy in [eV].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_energy-Tuple{Any}" href="#TestParticle.get_energy-Tuple{Any}"><code>TestParticle.get_energy</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the energy [eV] of a relativistic particle from Œ≥v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_energy-Tuple{SciMLBase.AbstractODESolution}" href="#TestParticle.get_energy-Tuple{SciMLBase.AbstractODESolution}"><code>TestParticle.get_energy</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the energy [eV] from relativistic <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_gc-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}}" href="#TestParticle.get_gc-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}}"><code>TestParticle.get_gc</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> get_gc(xu, param::Union{TPTuple, FullTPTuple})
 get_gc(x, y, z, vx, vy, vz, bx, by, bz, q2m)</code></pre><p>Calculate the coordinates of the guiding center according to the phase space coordinates of a particle. Reference: <a href="https://en.wikipedia.org/wiki/Guiding_center">wiki</a></p><p>Nonrelativistic definition:</p><p class="math-container">\[\mathbf{X}=\mathbf{x}-m\frac{\mathbf{b}\times\mathbf{v}}{qB}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/gc.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_gc_func-Tuple{Union{Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Tuple{Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField, TestParticle.AbstractField}}}" href="#TestParticle.get_gc_func-Tuple{Union{Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Tuple{Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField, TestParticle.AbstractField}}}"><code>TestParticle.get_gc_func</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> get_gc_func(param::Union{TPTuple, FullTPTuple})</code></pre><p>Return the function for plotting the orbit of guiding center.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">param = prepare(E, B; species=Proton)
# The definitions of stateinit, tspan, E and B are ignored.
prob = ODEProblem(trace!, stateinit, tspan, param)
sol = solve(prob, Vern7(); dt=2e-11)

f = Figure(fontsize=18)
ax = Axis3(f[1, 1], aspect = :data)
gc = param |&gt; get_gc_func
gc_plot(x,y,z,vx,vy,vz) = (gc(SA[x,y,z,vx,vy,vz])...,)
lines!(ax, sol, idxs=(gc_plot, 1, 2, 3, 4, 5, 6))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/gc.jl#L147-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_gyrofrequency" href="#TestParticle.get_gyrofrequency"><code>TestParticle.get_gyrofrequency</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the gyrofrequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_gyroperiod" href="#TestParticle.get_gyroperiod"><code>TestParticle.get_gyroperiod</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the gyroperiod.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_gyroradius-Tuple{AbstractFloat, AbstractFloat}" href="#TestParticle.get_gyroradius-Tuple{AbstractFloat, AbstractFloat}"><code>TestParticle.get_gyroradius</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the gyroradius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_velocity-Tuple{Any}" href="#TestParticle.get_velocity-Tuple{Any}"><code>TestParticle.get_velocity</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return velocity from relativistic Œ≥v in <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.prepare-Union{Tuple{TB}, Tuple{TE}, Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.ùîº, C&lt;:CoordRefSystems.Cartesian, N}, TE, TB}} where {TE, TB}" href="#TestParticle.prepare-Union{Tuple{TB}, Tuple{TE}, Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.ùîº, C&lt;:CoordRefSystems.Cartesian, N}, TE, TB}} where {TE, TB}"><code>TestParticle.prepare</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> prepare(grid::CartesianGrid, E, B; kwargs...) -&gt; (q2m, E, B)</code></pre><p>Return a tuple consists of particle charge-mass ratio for a prescribed <code>species</code> and interpolated EM field functions.</p><p><strong>Keywords</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic.</li><li><code>species::Species=Proton</code>: particle species.</li><li><code>q::AbstractFloat=1.0</code>: particle charge. Only works when <code>Species=User</code>.</li><li><code>m::AbstractFloat=1.0</code>: particle mass. Only works when <code>Species=User</code>.</li></ul><pre><code class="nohighlight hljs"> prepare(grid::CartesianGrid, E, B, F; species=Proton, q=1.0, m=1.0) -&gt; (q, m, E, B, F)</code></pre><p>Return a tuple consists of particle charge, mass for a prescribed <code>species</code> of charge <code>q</code> and mass <code>m</code>, interpolated EM field functions, and external force <code>F</code>.</p><pre><code class="nohighlight hljs"> prepare(x::AbstractRange, y::AbstractRange, z::AbstractRange, E, B; kwargs...) -&gt; (q2m, E, B)
 prepare(x, y, E, B; kwargs...) -&gt; (q2m, E, B)

 prepare(x::AbstractRange, E, B; kwargs...) -&gt; (q2m, E, B)</code></pre><p>1D grid. An additional keyword <code>dir</code> is used for specifying the spatial direction, 1 -&gt; x, 2 -&gt; y, 3 -&gt; z.</p><p>Direct range input for uniform grid in 2/3D is also accepted.</p><pre><code class="nohighlight hljs"> prepare(E, B; kwargs...) -&gt; (q2m, E, B)</code></pre><p>Return a tuple consists of particle charge-mass ratio for a prescribed <code>species</code> of charge <code>q</code> and mass <code>m</code> and analytic EM field functions. Prescribed <code>species</code> are <code>Electron</code> and <code>Proton</code>; other species can be manually specified with <code>species=Ion/User</code>, <code>q</code> and <code>m</code>.</p><pre><code class="nohighlight hljs"> prepare(E, B, F; kwargs...) -&gt; (q, m, E, B, F)</code></pre><p>Return a tuple consists of particle charge, mass for a prescribed <code>species</code> of charge <code>q</code> and mass <code>m</code>, analytic EM field functions, and external force <code>F</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L62-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.sample-Union{Tuple{Maxwellian{U, T}}, Tuple{T}, Tuple{U}} where {U, T}" href="#TestParticle.sample-Union{Tuple{Maxwellian{U, T}}, Tuple{T}, Tuple{U}} where {U, T}"><code>TestParticle.sample</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> sample(vdf::Maxwellian)</code></pre><p>Sample a 3D velocity from a <a href="#TestParticle.Maxwellian"><code>Maxwellian</code></a> distribution <code>vdf</code> using the Box-Muller method.</p><pre><code class="nohighlight hljs"> sample(vdf::BiMaxwellian)</code></pre><p>Sample a 3D velocity from a <a href="#TestParticle.BiMaxwellian"><code>BiMaxwellian</code></a> distribution <code>vdf</code> using the Box-Muller method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L69-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace!-Tuple{Any, Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace!-Tuple{Any, Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace!(dy, y, p::TPTuple, t)
 trace!(dy, y, p::FullTPTuple, t)</code></pre><p>ODE equations for charged particle moving in static EM field with in-place form.</p><p>ODE equations for charged particle moving in static EM field and external force field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace(y, p::TPTuple, t) -&gt; SVector{6, Float64}
 trace(y, p::FullTPTuple, t) -&gt; SVector{6, Float64}</code></pre><p>ODE equations for charged particle moving in static EM field with out-of-place form.</p><p>ODE equations for charged particle moving in static EM field and external force field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L38-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_gc!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_gc!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_gc!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_gc!(dy, y, p::TPTuple, t)</code></pre><p>Guiding center equations for nonrelativistic charged particle moving in static EM field with in-place form. Variable <code>y = (x, y, z, u)</code>, where <code>u</code> is the velocity along the magnetic field at (x,y,z).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L216-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_gc_1st!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_gc_1st!-Tuple{Any, Any, Tuple{Float64, Float64, Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_gc_1st!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>1st order approximation of guiding center equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_gc_drifts!-NTuple{4, Any}" href="#TestParticle.trace_gc_drifts!-NTuple{4, Any}"><code>TestParticle.trace_gc_drifts!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_gc_drifts!(dx, x, p, t)</code></pre><p>Equations for tracing the guiding center using analytical drifts, including the grad-B drift, curvature drift, and ExB drift. Parallel velocity is also added. This expression requires the full particle trajectory <code>p.sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L190-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_normalized!-Tuple{Any, Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_normalized!-Tuple{Any, Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_normalized!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_normalized!(dy, y, p::TPNormalizedTuple, t)</code></pre><p>Normalized ODE equations for charged particle moving in static EM field with in-place form. If the field is in 2D X-Y plane, periodic boundary should be applied for the field in z via the extrapolation function provided by Interpolations.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L120-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_relativistic!-Tuple{Any, Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_relativistic!-Tuple{Any, Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_relativistic!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_relativistic!(dy, y, p::TPTuple, t)</code></pre><p>ODE equations for relativistic charged particle (x, Œ≥v) moving in static EM field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L70-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_relativistic-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_relativistic-Tuple{Any, Tuple{Float64, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_relativistic</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_relativistic(y, p::TPTuple, t) -&gt; SVector{6}</code></pre><p>ODE equations for relativistic charged particle (x, Œ≥v) moving in static EM field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_relativistic_normalized!-Tuple{Any, Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_relativistic_normalized!-Tuple{Any, Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_relativistic_normalized!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_relativistic_normalized!(dy, y, p::TPNormalizedTuple, t)</code></pre><p>Normalized ODE equations for relativistic charged particle (x, Œ≥v) moving in static EM field with in-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.trace_relativistic_normalized-Tuple{Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}" href="#TestParticle.trace_relativistic_normalized-Tuple{Any, Tuple{AbstractFloat, TestParticle.AbstractField, TestParticle.AbstractField}, Any}"><code>TestParticle.trace_relativistic_normalized</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> trace_relativistic_normalized(y, p::TPNormalizedTuple, t)</code></pre><p>Normalized ODE equations for relativistic charged particle (x, Œ≥v) moving in static EM field with out-of-place form.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/equations.jl#L166-L170">source</a></section></article><h2 id="Private-types-and-methods"><a class="docs-heading-anchor" href="#Private-types-and-methods">Private types and methods</a><a id="Private-types-and-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Private-types-and-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.AbstractTraceSolution" href="#TestParticle.AbstractTraceSolution"><code>TestParticle.AbstractTraceSolution</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type for tracing solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/TestParticle.jl#L34-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.Field" href="#TestParticle.Field"><code>TestParticle.Field</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> Field{itd, F} &lt;: AbstractField{itd}</code></pre><p>A representation of a field function <code>f</code>, defined by:</p><p>time-independent field</p><p class="math-container">\[\mathbf{F} = F(\mathbf{x}),\]</p><p>time-dependent field</p><p class="math-container">\[\mathbf{F} = F(\mathbf{x}, t).\]</p><p><strong>Arguments</strong></p><ul><li><code>field_function::Function</code>: the function of field.</li><li><code>itd::Bool</code>: whether the field function is time dependent.</li><li><code>F</code>: the type of <code>field_function</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L10-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.FullTPTuple" href="#TestParticle.FullTPTuple"><code>TestParticle.FullTPTuple</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The type of parameter tuple for full test particle problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.GCTuple" href="#TestParticle.GCTuple"><code>TestParticle.GCTuple</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The type of parameter tuple for guiding center problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.Species" href="#TestParticle.Species"><code>TestParticle.Species</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type for the particles, <code>Proton</code>, <code>Electron</code>, <code>Ion</code>, or <code>User</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/TestParticle.jl#L29-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.TPNormalizedTuple" href="#TestParticle.TPNormalizedTuple"><code>TestParticle.TPNormalizedTuple</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The type of parameter tuple for normalized test particle problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.TPTuple" href="#TestParticle.TPTuple"><code>TestParticle.TPTuple</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The type of parameter tuple for normal test particle problem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.TraceSolution-Union{Tuple{Any}, Tuple{deriv}, Tuple{Any, Type{deriv}}} where deriv" href="#TestParticle.TraceSolution-Union{Tuple{Any}, Tuple{deriv}, Tuple{Any, Type{deriv}}} where deriv"><code>TestParticle.TraceSolution</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Interpolate solution at time <code>x</code>. Forward tracing only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.VDF" href="#TestParticle.VDF"><code>TestParticle.VDF</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type for velocity distribution functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/sampler.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle._boris!-NTuple{8, Any}" href="#TestParticle._boris!-NTuple{8, Any}"><code>TestParticle._boris!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Apply Boris method for particles with index in <code>irange</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle._prepare-NTuple{4, Any}" href="#TestParticle._prepare-NTuple{4, Any}"><code>TestParticle._prepare</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Prepare for advancing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.cross!-Tuple{Any, Any, Any}" href="#TestParticle.cross!-Tuple{Any, Any, Any}"><code>TestParticle.cross!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>In-place cross product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.dipole-Tuple{Any, Any}" href="#TestParticle.dipole-Tuple{Any, Any}"><code>TestParticle.dipole</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculates the magnetic field from a dipole with magnetic moment <code>M</code> at <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/dipole.jl#L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.dipole_fieldline" href="#TestParticle.dipole_fieldline"><code>TestParticle.dipole_fieldline</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> dipole_fieldline(œï, L=2.5, nP=100)</code></pre><p>Creates <code>nP</code> points on one field line of the magnetic field from a dipole. In a centered dipole magnetic field model, the path along a given L shell can be described as r = L*cos¬≤Œª, where r is the radial distance (in planetary radii) to a point on the line, Œª is its co-latitude, and L is the L-shell of interest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/dipole.jl#L26-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_CS_harris" href="#TestParticle.getB_CS_harris"><code>TestParticle.getB_CS_harris</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_CS_harris(B‚ÇÄ, L)</code></pre><p>Return the magnetic field at location <code>r</code> near a current sheet with magnetic strength <code>B‚ÇÄ</code> and sheet length <code>L</code>. The current sheet is assumed to lie in the z = 0 plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/current_sheet.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_bottle-NTuple{8, Any}" href="#TestParticle.getB_bottle-NTuple{8, Any}"><code>TestParticle.getB_bottle</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_bottle(x, y, z, distance, a, b, I1, I2) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field from a magnetic bottle. Reference: <a href="https://en.wikipedia.org/wiki/Magnetic_mirror#Magnetic_bottles">wiki</a></p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>b::Float</code>: radius of central coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils in [A].</li><li><code>I2::Float</code>: current in the central solenoid times number of windings in the</li></ul><p>central loop in [A].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/confinement.jl#L68-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_current_loop-Tuple{Any, Any, Any, TestParticle.Currentloop}" href="#TestParticle.getB_current_loop-Tuple{Any, Any, Any, TestParticle.Currentloop}"><code>TestParticle.getB_current_loop</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_current_loop(x, y, z, cl::Currentloop) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field at <code>[x, y, z]</code> from a magnetic mirror generated from two coils.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/confinement.jl#L18-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_dipole-Tuple{Any}" href="#TestParticle.getB_dipole-Tuple{Any}"><code>TestParticle.getB_dipole</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic magnetic field function for testing. Return in SI unit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/dipole.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_mirror-NTuple{6, Any}" href="#TestParticle.getB_mirror-NTuple{6, Any}"><code>TestParticle.getB_mirror</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_mirror(x, y, z, distance, a, I1) -&gt; StaticVector{Float64, 3}</code></pre><p>Get magnetic field at <code>[x, y, z]</code> from a magnetic mirror generated from two coils.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: particle coordinates in [m].</li><li><code>distance::Float</code>: distance between solenoids in [m].</li><li><code>a::Float</code>: radius of each side coil in [m].</li><li><code>I1::Float</code>: current in the solenoid times number of windings in side coils.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/confinement.jl#L42-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_tokamak_coil-NTuple{7, Any}" href="#TestParticle.getB_tokamak_coil-NTuple{7, Any}"><code>TestParticle.getB_tokamak_coil</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_tokamak_coil(x, y, z, a, b, ICoils, IPlasma) -&gt; StaticVector{Float64, 3}</code></pre><p>Get the magnetic field from a Tokamak topology consists of 16 coils. Original: <a href="https://github.com/BoschSamuel/Simulation-of-a-Tokamak-Fusion-Reactor/blob/master/Simulation2.m">Tokamak-Fusion-Reactor</a></p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: location in [m].</li><li><code>a::Float</code>: radius of each coil in [m].</li><li><code>b::Float</code>: radius of central region in [m].</li><li><code>ICoil::Float</code>: current in the coil times number of windings in [A].</li><li><code>IPlasma::Float</code>: current of the plasma in [A].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/confinement.jl#L98-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getB_tokamak_profile-Tuple{AbstractFloat, AbstractFloat, AbstractFloat, Any, AbstractFloat, AbstractFloat, AbstractFloat}" href="#TestParticle.getB_tokamak_profile-Tuple{AbstractFloat, AbstractFloat, AbstractFloat, Any, AbstractFloat, AbstractFloat, AbstractFloat}"><code>TestParticle.getB_tokamak_profile</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getB_tokamak_profile(x, y, z, q_profile, a, R‚ÇÄ, BŒ∂0) -&gt; StaticVector{Float64, 3}</code></pre><p>Reconstruct the magnetic field distribution from a safe factor(q) profile. Reference: Tokamak, 4th Edition, John Wesson.</p><p><strong>Arguments</strong></p><ul><li><code>x,y,z::Float</code>: location in [m].</li><li><code>q_profile::Function</code>: profile of q. The variable of this function must be the normalized radius.</li><li><code>a::Float</code>: minor radius [m].</li><li><code>R‚ÇÄ::Float</code>: major radius [m].</li><li><code>BŒ∂0::Float</code>: toroidal magnetic field on axis [T].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/confinement.jl#L184-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getE_dipole-Tuple{Any}" href="#TestParticle.getE_dipole-Tuple{Any}"><code>TestParticle.getE_dipole</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic electric field function for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/dipole.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.get_rotation_matrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}" href="#TestParticle.get_rotation_matrix-Tuple{AbstractVector{&lt;:AbstractFloat}, Real}"><code>TestParticle.get_rotation_matrix</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> get_rotation_matrix(axis::AbstractVector, angle::Real) --&gt; SMatrix{3,3}</code></pre><p>Create a rotation matrix for rotating a 3D vector around a unit <code>axis</code> by an <code>angle</code> in radians. Reference: <a href="https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle">Rotation matrix from axis and angle</a></p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using LinearAlgebra
v = [-0.5, 1.0, 1.0]
vÃÇ = normalize(v)
Œ∏ = deg2rad(-74)
R = get_rotation_matrix(vÃÇ, Œ∏)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L66-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getchargemass-Tuple{TestParticle.Species, AbstractFloat, AbstractFloat}" href="#TestParticle.getchargemass-Tuple{TestParticle.Species, AbstractFloat, AbstractFloat}"><code>TestParticle.getchargemass</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getchargemass(species::Species, q::AbstractFloat, m::AbstractFloat)</code></pre><p>Return charge and mass for <code>species</code>. if <code>species = User</code>, input <code>q</code> and <code>m</code> are returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getinterp" href="#TestParticle.getinterp"><code>TestParticle.getinterp</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getinterp(A, gridx, gridy, gridz, order::Int=1, bc::Int=1)
 getinterp(A, gridx, gridy, order::Int=1, bc::Int=1)
 getinterp(A, gridx, order::Int=1, bc::Int=1, dir::Int=1)</code></pre><p>Return a function for interpolating field array <code>A</code> on the grid given by <code>gridx</code>, <code>gridy</code>, and <code>gridz</code>.</p><p><strong>Arguments</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic, 3 -&gt; Flat.</li><li><code>dir::Int</code>: 1/2/3, representing x/y/z direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/interpolation.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.getinterp_scalar" href="#TestParticle.getinterp_scalar"><code>TestParticle.getinterp_scalar</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> getinterp_scalar(A, gridx, gridy, gridz, order::Int=1, bc::Int=1)</code></pre><p>Return a function for interpolating scalar array <code>A</code> on the grid given by <code>gridx</code>, <code>gridy</code>, and <code>gridz</code>. Currently only 3D arrays are supported.</p><p><strong>Arguments</strong></p><ul><li><code>order::Int=1</code>: order of interpolation in [1,2,3].</li><li><code>bc::Int=1</code>: type of boundary conditions, 1 -&gt; NaN, 2 -&gt; periodic, 3 -&gt; Flat.</li><li><code>dir::Int</code>: 1/2/3, representing x/y/z direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/interpolation.jl#L137-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.is_time_dependent-Tuple{Function}" href="#TestParticle.is_time_dependent-Tuple{Function}"><code>TestParticle.is_time_dependent</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Judge whether the field function is time dependent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/prepare.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.makegrid-Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.ùîº, C&lt;:CoordRefSystems.Cartesian, N}}" href="#TestParticle.makegrid-Tuple{Meshes.CartesianGrid{M, C, N} where {M&lt;:Meshes.ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>TestParticle.makegrid</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return uniform range from 2D/3D CartesianGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.set_axes_equal-Tuple{Any}" href="#TestParticle.set_axes_equal-Tuple{Any}"><code>TestParticle.set_axes_equal</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> set_axes_equal(ax)</code></pre><p>Set 3D plot axes to equal scale for Matplotlib. Make axes of 3D plot have equal scale so that spheres appear as spheres and cubes as cubes. Required since <code>ax.axis(&#39;equal&#39;)</code> and <code>ax.set_aspect(&#39;equal&#39;)</code> don&#39;t work on 3D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L46-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.solve" href="#TestParticle.solve"><code>TestParticle.solve</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> solve(prob::TraceProblem; trajectories::Int=1,
	 savestepinterval::Int=1, isoutofdomain::Function=ODE_DEFAULT_ISOUTOFDOMAIN)</code></pre><p>Trace particles using the Boris method with specified <code>prob</code>.</p><p><strong>keywords</strong></p><ul><li><code>trajectories::Int</code>: number of trajectories to trace.</li><li><code>savestepinterval::Int</code>: saving output interval.</li><li><code>isoutofdomain::Function</code>: a function with input of position and velocity vector <code>xv</code> that determines whether to stop tracing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L164-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.sph2cart-Tuple{Any, Any, Any}" href="#TestParticle.sph2cart-Tuple{Any, Any, Any}"><code>TestParticle.sph2cart</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert from spherical to Cartesian coordinates vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/utility/utility.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.update_location!-Tuple{Any, Any}" href="#TestParticle.update_location!-Tuple{Any, Any}"><code>TestParticle.update_location!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update location in one timestep <code>dt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TestParticle.update_velocity!-NTuple{5, Any}" href="#TestParticle.update_velocity!-NTuple{5, Any}"><code>TestParticle.update_velocity!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> update_velocity!(xv, paramBoris, param, dt, t)</code></pre><p>Update velocity using the Boris method, Birdsall, Plasma Physics via Computer Simulation. Reference: <a href="https://apps.dtic.mil/sti/citations/ADA023511">DTIC</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/henry2004y/TestParticle.jl/blob/3396abe71c157667c76e9534f8ca785b4b2c50fd/src/pusher.jl#L106-L111">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">¬´ Examples</a><a class="docs-footer-nextpage" href="../plotfunctions/">Plot Functions ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Friday 9 May 2025 00:06">Friday 9 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
